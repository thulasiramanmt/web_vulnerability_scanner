import requests

def check_sql_injection(url):
    sql_payloads = ["' OR '1'='1", "' OR '1'='1' -- "]
    for payload in sql_payloads:
        full_url = f"{url}?id={payload}"
        response = requests.get(full_url)
        if "error" in response.text.lower():
            print(f"[!] Potential SQL Injection vulnerability detected at {full_url}")

def check_xss(url):
    xss_payloads = ["<script>alert('XSS')</script>", "<img src='x' onerror='alert(1)'>"]
    for payload in xss_payloads:
        full_url = f"{url}?q={payload}"
        response = requests.get(full_url)
        if payload in response.text:
            print(f"[!] Potential XSS vulnerability detected at {full_url}")


def check_headers(url):
    response = requests.get(url)
    security_headers = ["X-Content-Type-Options", "X-Frame-Options", "Content-Security-Policy"]
    for header in security_headers:
        if header not in response.headers:
            print(f"[!] Missing security header: {header}")


if __name__ == "__main__":
    target_url = "http://example.com"  # Replace with a working url
    print("Starting SQL Injection Check...")
    check_sql_injection(target_url)
    print("Starting XSS Check...")
    check_xss(target_url)
    print("Checking for Missing Security Headers...")
    check_headers(target_url)
